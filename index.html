<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Typing Sky Game</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(to top, #4da6ff, #99ccff);
    font-family: monospace;
    user-select: none;
  }

  #gameCanvas { display: block; width: 100vw; height: 100vh; }

  #score, #level, #lives {
    position: absolute;
    left: 10px;
    color: white;
    font-size: 20px;
    text-shadow: 0 0 4px #000;
  }

  #score { top: 10px; }
  #level { top: 40px; }
  #lives { top: 70px; }

  #levelUp, #gameOver {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: yellow;
    font-size: 60px;
    opacity: 0;
    transition: opacity 0.5s ease;
    text-align: center;
    text-shadow: 0 0 10px #000;
  }

  #gameOver span { display: block; font-size: 80px; margin-top: 20px; }

  #restartBtn {
    display: none;
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 12px 24px;
    font-size: 24px;
    border: none;
    border-radius: 8px;
    background-color: #ffcc00;
    cursor: pointer;
  }

  #tapStart {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 24px;
    text-align: center;
    text-shadow: 0 0 4px #000;
    cursor: pointer;
  }

  /* Mobile keyboard fix */
  #inputField {
    position: absolute;
    top: 0;
    left: 0;
    width: 1px;
    height: 1px;
    opacity: 0.01;
    z-index: -1;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="score">Score: 0</div>
<div id="level">Level: 1</div>
<div id="lives">Lives: 3</div>
<div id="levelUp">LEVEL UP!</div>
<div id="gameOver">
  GAME OVER
  <span>ðŸ’€</span>
</div>
<div id="tapStart">Tap to Start Typing</div>
<button id="restartBtn">Restart Game</button>
<input type="text" id="inputField" />

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// Words
const words = [
"code","fast","type","game","sky","birds","speed","focus","react","skill",
"storm","cloud","fire","water","earth","stone","leaf","tree","sun","moon",
"jump","run","play","fun","joy","win","lose","hope","dream","wish","plan",
"build","create","grow","travel","explore","find","seek","catch","throw","kick"
];

let activeWords = [];
let birds = [];
let score = 0;
let level = 1;
let fallSpeed = 1.5;
let nextLevelScore = 30;
let lives = 3;
let gameOver = false;
let spawnInterval = null;

// Sounds
const popSound = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
const levelUpSound = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
const lifeLostSound = new Audio("https://actions.google.com/sounds/v1/cartoon/clang.ogg");
const destroySound = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
const gameOverSound = new Audio("https://cdn.pixabay.com/download/audio/2021/08/04/audio_07d012c391.mp3?filename=horror-ambience-6036.mp3");

// Birds
for (let i = 0; i < 8; i++) {
  birds.push({ x: Math.random() * canvas.width, y: Math.random() * (canvas.height / 2), speed: 1 + Math.random() * 1.5 });
}

function drawBirds() {
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;
  birds.forEach(bird => {
    ctx.beginPath();
    ctx.moveTo(bird.x, bird.y);
    ctx.quadraticCurveTo(bird.x + 10, bird.y - 5, bird.x + 20, bird.y);
    ctx.moveTo(bird.x + 20, bird.y);
    ctx.quadraticCurveTo(bird.x + 30, bird.y - 5, bird.x + 40, bird.y);
    ctx.stroke();
  });
}

function updateBirds() {
  birds.forEach(bird => {
    bird.x += bird.speed;
    if (bird.x > canvas.width + 50) {
      bird.x = -50;
      bird.y = Math.random() * (canvas.height / 2);
    }
  });
}

function spawnWord() {
  if (!gameOver) {
    const text = words[Math.floor(Math.random() * words.length)];
    const x = Math.random() * (canvas.width - 150);
    activeWords.push({ text, x, y: 0 });
  }
}

function drawWords() {
  ctx.font = "24px monospace";
  ctx.fillStyle = "white";
  activeWords.forEach(word => ctx.fillText(word.text, word.x, word.y));
}

function updateWords() {
  for (let i = 0; i < activeWords.length; i++) {
    activeWords[i].y += fallSpeed;
    if (activeWords[i].y > canvas.height) {
      activeWords.splice(i, 1);
      loseLife();
      i--;
    }
  }
}

// âœ… Letter-by-letter typing (in order)
function handleLetter(letter) {
  for (let i = 0; i < activeWords.length; i++) {
    let word = activeWords[i];
    if (word.text[0] === letter.toLowerCase()) {
      word.text = word.text.slice(1);
      popSound.currentTime = 0;
      popSound.play();
      score++;
      document.getElementById("score").textContent = "Score: " + score;
      if (word.text.length === 0) {
        activeWords.splice(i, 1);
        destroySound.currentTime = 0;
        destroySound.play();
        checkLevelUp();
      }
      return;
    }
  }
}

function checkLevelUp() {
  if (score >= nextLevelScore) {
    level++;
    fallSpeed += 1.5;
    nextLevelScore += 40;
    document.getElementById("level").textContent = "Level: " + level;
    levelUpSound.currentTime = 0;
    levelUpSound.play();
    const div = document.getElementById("levelUp");
    div.style.opacity = "1";
    setTimeout(() => div.style.opacity = "0", 1000);
  }
}

function loseLife() {
  lives--;
  lifeLostSound.currentTime = 0;
  lifeLostSound.play();
  document.getElementById("lives").textContent = "Lives: " + lives;
  if (lives <= 0) endGame();
}

function endGame() {
  gameOver = true;
  document.getElementById("gameOver").style.opacity = "1";
  document.getElementById("restartBtn").style.display = "block";
  gameOverSound.currentTime = 0;
  gameOverSound.play();
  if (spawnInterval) {
    clearInterval(spawnInterval);
    spawnInterval = null;
  }
}

document.getElementById("restartBtn").addEventListener("click", () => {
  score = 0;
  level = 1;
  fallSpeed = 1.5;
  nextLevelScore = 30;
  lives = 3;
  activeWords = [];
  gameOver = false;
  document.getElementById("score").textContent = "Score: " + score;
  document.getElementById("level").textContent = "Level: " + level;
  document.getElementById("lives").textContent = "Lives: " + lives;
  document.getElementById("gameOver").style.opacity = "0";
  document.getElementById("restartBtn").style.display = "none";
  document.getElementById("tapStart").style.display = "block";
  if (spawnInterval) clearInterval(spawnInterval);
  spawnInterval = null;
});

const input = document.getElementById("inputField");
input.addEventListener("input", e => {
  const letter = e.target.value;
  if (letter) handleLetter(letter);
  e.target.value = "";
});

// âœ… Tap to start (mobile keyboard fix)
const tapStart = document.getElementById("tapStart");
tapStart.addEventListener("click", () => {
  input.style.width = "100px";
  input.style.height = "30px";
  input.style.opacity = "0.5";
  input.style.zIndex = "1000";
  input.focus();

  setTimeout(() => {
    input.style.width = "1px";
    input.style.height = "1px";
    input.style.opacity = "0.01";
    input.style.zIndex = "-1";
  }, 500);

  tapStart.style.display = "none";
  startGame();
});

function startGame() {
  if (spawnInterval) clearInterval(spawnInterval);
  spawnInterval = setInterval(() => { if (!gameOver) spawnWord(); }, 2000);
  animate();
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  updateBirds();
  drawBirds();
  updateWords();
  drawWords();
  if (!gameOver) requestAnimationFrame(animate);
}

document.body.addEventListener("click", () => input.focus());
window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body>
  </html>
